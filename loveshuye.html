<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>动态爱心特效</title>  
    <style>  
        body {  
            margin: 0;  
            overflow: hidden;  
            background-color: black;  
        }  
        canvas {  
            display: block;  
        }  
    </style>  
</head>  
<body>  
    <canvas id="canvas"></canvas>  
    <script>  
        const canvas = document.getElementById('canvas');  
        const ctx = canvas.getContext('2d');  
        canvas.width = window.innerWidth;  
        canvas.height = window.innerHeight;  

        let particles = [];  
        let animationState = 'forming'; // 动画状态  
        let startTime = null;  

        class Particle {  
            constructor(x, y, color) {  
                this.x = x;  
                this.y = y;  
                this.size = Math.random() * 5 + 1;  
                this.speedX = (Math.random() - 0.5) * 4; // 随机水平速度  
                this.speedY = Math.random() * -3 - 1; // 向上运动  
                this.color = color;  
                this.lifetime = Math.random() * 100 + 50; // 设置粒子的生命周期  
            }  

            update() {  
                this.x += this.speedX;  
                this.y += this.speedY;  
                this.size *= 0.95; // 粒子逐渐变小  
                this.lifetime--; // 减少生命周期  
            }  

            draw() {  
                ctx.fillStyle = this.color;  
                ctx.beginPath();  
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);  
                ctx.fill();  
            }  
        }  

        function createHeartShape() {  
            const heartShape = [];  
            for (let t = 0; t < Math.PI * 2; t += 0.1) {  
                const x = 16 * Math.sin(t) ** 3;  
                const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);  
                heartShape.push({ x: x * 10 + canvas.width / 2, y: -y * 10 + canvas.height / 2 });  
            }  
            return heartShape;  
        }  

        function animate(timestamp) {  
            if (!startTime) startTime = timestamp;  
            const elapsed = timestamp - startTime;  

            ctx.clearRect(0, 0, canvas.width, canvas.height);  

            if (animationState === 'forming' && elapsed < 2000) {  
                // 形成爱心  
                const heartShape = createHeartShape();  
                heartShape.forEach(point => {  
                    for (let i = 0; i < 10; i++) { // 每个心形点生成10个粒子  
                        const color = (Math.random() < 0.5) ? 'rgba(255, 0, 0, 0.8)' : 'rgba(0, 0, 255, 0.8)'; // 随机选择红色或蓝色  
                        particles.push(new Particle(point.x, point.y, color));  
                    }  
                });  
            } else if (animationState === 'visible' && elapsed < 5000) {  
                // 爱心可见  
                const heartShape = createHeartShape();  
                heartShape.forEach(point => {  
                    for (let i = 0; i < 5555; i++) { // 每个心形点生成5个粒子  
                        const color = (Math.random() < 0.5) ? 'rgba(255, 0, 0, 0.8)' : 'rgba(0, 0, 255, 0.8)'; // 随机选择红色或蓝色  
                        particles.push(new Particle(point.x, point.y, color));  
                    }  
                });  
            } else if (elapsed >= 5000) {  
                // 重置动画  
                startTime = null;  
                particles = [];  
                animationState = 'forming';  
                return; // 结束当前帧  
            }  

            particles.forEach((particle, index) => {  
                particle.update();  
                particle.draw();  
                if (particle.lifetime <= 0 || particle.size <= 0.2) {  
                    particles.splice(index, 1);  
                }  
            });  

            requestAnimationFrame(animate);  
        }  

        window.addEventListener('resize', () => {  
            canvas.width = window.innerWidth;  
            canvas.height = window.innerHeight;  
        });  

        // 启动动画  
        animate();  

        // 每隔一段时间切换状态  
        setInterval(() => {  
            if (animationState === 'forming') {  
                animationState = 'visible'; // 切换到可见状态  
            } else {  
                animationState = 'forming'; // 切换到形成状态  
            }  
        }, 7000); // 每7秒切换状态  

    </script>  
</body>  
</html>
